# Load the dataframe
df <- read.csv("dfDesign.csv")
table(df$outcome)
df$outcome <- ifelse(is.na(df$outcome), "Negative Affect", df$outcome)
table(df$outcome)
df$outcome <- case_match(df$outcome,
"ERLookDiff" ~ "Task-based Ratings",
"neoN" ~ "Neuroticism",
"neoN1" ~ "N1:Anxiety",
"neoN2" ~ "N2:Hostility",
"neoN3" ~ "N3:Depression",
"neoN4" ~ "N1:Anxiety",
"neoN5" ~ "N2:Hostility",
"neoN6" ~ "N3:Depression",
"NEONother" ~ "N:Other",
"NEONX" ~ "N:Other+Self",
"PA" ~ "Positive Affect")
table(df$outcome)
# Load the dataframe
df <- read.csv("dfDesign.csv")
df$outcome <- ifelse(is.na(df$outcome), "Negative Affect", df$outcome)
df$outcome
table(df$outcome)
runApp()
runApp()
runApp()
table(df$data)
dtable(df$contrast)
table(df$contrast)
table(df$trainsVsFull)
table(df$rescale)
df$data <- case_match(df$data,
"IAPS" ~ "scenes",
"PFA" ~ "faces")
df$contrast <- case_match(df$contrast,
"controlCond" ~ "Neutral Scenes/Shapes",
"implBaseline" ~ "Implicit Baseline")
df$trainsVsFull <- case_match(df$trainsVsFull,
"AHAB" ~ "AHAB2 subsample",
"full" ~ "Full Data",
"train" ~ "Training Data Only")
table(df$rescale)
df$rescale <- case_match(df$rescale,
"cente" ~ "Image-wise Centering",
"nocen" ~ "No image-wise scaling",
"zscor" ~ "Image-wise z-scoring")
table(df$algorithm)
runApp()
names(df)
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
library(rsconnect)
rsconnect::setAccountInfo(name='msicorello',
token='6E092B704FC286AAF0CACF9A2AF595DD',
secret='<SECRET>')
rsconnect::setAccountInfo(name='msicorello',
token='6E092B704FC286AAF0CACF9A2AF595DD',
secret='<SECRET>')
rsconnect::setAccountInfo(name='msicorello',
token='6E092B704FC286AAF0CACF9A2AF595DD',
secret='<SECRET>')
rsconnect::setAccountInfo(name='msicorello',
token='6E092B704FC286AAF0CACF9A2AF595DD',
secret='<SECRET>')
rsconnect::setAccountInfo(name='msicorello',
token='6E092B704FC286AAF0CACF9A2AF595DD',
secret='dfeBvEKBrWtuE0bttvPLueQs93leSMPQMBLladbI')
getwd()
rsconnect::deployApp()
library('MASS')
# set sample size of individual groups and the two within-group correlations
samples = 100
r1 = 0.50
r2 = 0.25
# to create panel plot
par(mfrow = c(2,3))
# Relationship in group 1. r = .28. Mean on both variables is 3
data1 = mvrnorm(n=samples, mu=c(4.5, 4.5), Sigma=matrix(c(1, r1, r1, 1), nrow=2), empirical=TRUE)
plot(data1, xlim = c(1, 10), ylim = c(1, 8), main = "group 1, r = .50", xlab = "x", ylab = "y")
# Relationship in group 2. r = .28. Mean on both variables is 6
data2 = mvrnorm(n=samples, mu=c(4.5, 4.5), Sigma=matrix(c(1, r2, r2, 1), nrow=2), empirical=TRUE)
plot(data2, xlim = c(1, 10), ylim = c(1, 8), main = "group 2, r = .25", xlab = "x", ylab = "y")
# correlation in the full dataset (both groups combined)
dataFull <- rbind(data1, data2)
plot(dataFull,  xlim = c(1, 10), ylim = c(1, 8), main = "combined, r = .38", xlab = "x", ylab = "y")
cor(dataFull)
# replace c(6, 6) in line 15 with c(3, 3). Group two has now the same means on X and Y as group one.
# The correlation in the whole sample then becomes approx. the mean of r1 and r2.
# If you choose c(6, 2) instead of c(6, 6), the correlation becomes strongly negative.
# including group membership as a covariate controls for this effect
dataFull = cbind(dataFull, rep(c(0, 1), each = 100))
dataFull = as.data.frame(dataFull)
names(dataFull) <- c("y", "x", "g")
dataFull = as.data.frame(apply(dataFull, 2, scale))
lm(y ~ ., data = dataFull)
library('MASS')
# set sample size of individual groups and the two within-group correlations
samples = 100
r1 = 0.50
r2 = 0.25
# to create panel plot
par(mfrow = c(2,3))
# Relationship in group 1. r = .28. Mean on both variables is 3
data1 = mvrnorm(n=samples, mu=c(4.5, 4.5), Sigma=matrix(c(1, r1, r1, 1), nrow=2), empirical=TRUE)
plot(data1, xlim = c(1, 10), ylim = c(1, 8), main = "group 1, r = .50", xlab = "x", ylab = "y")
# Relationship in group 2. r = .28. Mean on both variables is 6
data2 = mvrnorm(n=samples, mu=c(4.5, 4.5), Sigma=matrix(c(1, r2, r2, 1), nrow=2), empirical=TRUE)
plot(data2, xlim = c(1, 10), ylim = c(1, 8), main = "group 2, r = .25", xlab = "x", ylab = "y")
# correlation in the full dataset (both groups combined)
dataFull <- rbind(data1, data2)
plot(dataFull,  xlim = c(1, 10), ylim = c(1, 8), main = "combined, r = .38", xlab = "x", ylab = "y")
# including group membership as a covariate controls for this effect
dataFull = cbind(dataFull, rep(c(0, 1), each = 100))
dataFull = as.data.frame(dataFull)
names(dataFull) <- c("y", "x", "g")
dataFull = as.data.frame(apply(dataFull, 2, scale))
lm(y ~ ., data = dataFull)
# set sample size of individual groups and the two within-group correlations
samples = 100
r1 = 0.50
r2 = 0.25
# to create panel plot
par(mfrow = c(2,3))
# Relationship in group 1. r = .28. Mean on both variables is 3
data1 = mvrnorm(n=samples, mu=c(4.5, 4.5), Sigma=matrix(c(1, r1, r1, 1), nrow=2), empirical=TRUE)
library('MASS')
# set sample size of individual groups and the two within-group correlations
samples = 100
r1 = 0.50
r2 = 0.25
# to create panel plot
par(mfrow = c(2,3))
# Relationship in group 1. r = .28. Mean on both variables is 3
data1 = mvrnorm(n=samples, mu=c(3, 3), Sigma=matrix(c(1, r1, r1, 1), nrow=2), empirical=TRUE)
plot(data1, xlim = c(1, 10), ylim = c(1, 8), main = "group 1, r = .50", xlab = "x", ylab = "y")
# Relationship in group 2. r = .28. Mean on both variables is 6
data2 = mvrnorm(n=samples, mu=c(6, 6), Sigma=matrix(c(1, r2, r2, 1), nrow=2), empirical=TRUE)
plot(data2, xlim = c(1, 10), ylim = c(1, 8), main = "group 2, r = .25", xlab = "x", ylab = "y")
# correlation in the full dataset (both groups combined)
dataFull <- rbind(data1, data2)
plot(dataFull,  xlim = c(1, 10), ylim = c(1, 8), main = "combined, r = .38", xlab = "x", ylab = "y")
mean(0.5,0.25)
mean(c(0.5,0.25))
# including group membership as a covariate controls for this effect
dataFull = cbind(dataFull, rep(c(0, 1), each = 100))
dataFull = as.data.frame(dataFull)
names(dataFull) <- c("y", "x", "g")
dataFull = as.data.frame(apply(dataFull, 2, scale))
lm(y ~ ., data = dataFull)
N = 150
N = 150
T1 <- rnorm(150)
H <- rnorm(150)
matrix(1, -.20, 1, -.20)
corrMat <- matrix(1, -.20, 1, -.20)
corrMat <- matrix(c(1, -.20, 1, -.20))
corrMat
corrMat <- matrix(c(1, -.20, 1, -.20), nrow=2)
corrMat
corrMat <- matrix(c(1,  1, -.20, -.20), nrow=2)
corrMat
corrMat <- matrix(c(1,  -.20, -.20, 1), nrow=2)
corrMat
library("MASS")
?mvrnorm
corrMat <-
mvrnorm(n=150, mu=c(0,0), Sigma=matrix(c(1,  -.20, -.20, 1), nrow=2))
corrMat <-
dat <- mvrnorm(n=150, mu=c(0,0), Sigma=matrix(c(1,  -.20, -.20, 1), nrow=2))
dat <- mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  -.20, -.20, 1), nrow=2))
cor(dat)
name(dat) <- c("T1", "Brain")
names(dat) <- c("T1", "Brain")
datT1
dat <- mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  -.20, -.20, 1), nrow=2))
names(dat) <- c("T1", "Brain")
datT1
dat$T1
dat <- mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  -.20, -.20, 1), nrow=2))
dat <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  -.20, -.20, 1), nrow=2)))
names(dat) <- c("T1", "Brain")
dat$T1
N = 150
effAR = 0.5
effBrain = 0.15
dat <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  -.20, -.20, 1), nrow=2)))
names(dat) <- c("T1", "Brain")
dat$T3 <- 0.5*dat$T1 +
dat$
effAR^2
effAR = 0.5
effBrain = 0.15
effAR^2
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
err
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
summary(lm(data=dat, T3 ~ T1 + Brain))
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(0.1,0.1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
library("MASS")
N = 50
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(0.1,0.1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
names(dat) <- c("T1", "Brain")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
summary(lm(data=dat, T3 ~ T1 + Brain))
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
dat$group
library("MASS")
library("")
library("MASS")
library("lme4")
N = 50
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(0.1,0.1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
names(dat) <- c("T1", "Brain")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
dat
library("MASS")
library("lme4")
N = 50
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(0.1,0.1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
names(dat) <- c("T1", "Brain", "group")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
dat
summary(lm(data=dat, T3 ~ T1 + Brain))
library("MASS")
library("lme4")
N = 50
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
set.seed(100)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(0.1,0.1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
names(dat) <- c("T1", "Brain", "group")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
summary(lm(data=dat, T3 ~ T1 + Brain + group))
library("MASS")
library("lme4")
N = 50
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
set.seed(100)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(0.1,0.1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
names(dat) <- c("T1", "Brain", "group")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
summary(lm(data=dat, T3 ~ T1 + Brain + group))
library("MASS")
library("lme4")
N = 50
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
set.seed(100)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(0.1,0.1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
names(dat) <- c("T1", "Brain", "group")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
summary(lm(data=dat, T3 ~ T1 + Brain))
library("MASS")
library("lme4")
N = 50
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
set.seed(100)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(0.1,0.1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
names(dat) <- c("T1", "Brain", "group")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
summary(lm(data=dat, T3 ~ T1 + Brain))
library("MASS")
library("lme4")
N = 50
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
set.seed(100)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(0.1,0.1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
names(dat) <- c("T1", "Brain", "group")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
summary(lm(data=dat, T3 ~ T1 + Brain + Group))
library("MASS")
library("lme4")
N = 50
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
set.seed(100)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(0.1,0.1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
names(dat) <- c("T1", "Brain", "group")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
summary(lm(data=dat, T3 ~ T1 + Brain + group))
library("MASS")
library("lme4")
N = 50
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
set.seed(100)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(1,1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
names(dat) <- c("T1", "Brain", "group")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
summary(lm(data=dat, T3 ~ T1 + Brain + group))
library("MASS")
library("lme4")
N = 50
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
set.seed(100)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(1,1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
names(dat) <- c("T1", "Brain", "group")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
summary(lm(data=dat, T3 ~ T1 + Brain + group))
library("MASS")
library("lme4")
N = 50
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
set.seed(100)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(1,1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
names(dat) <- c("T1", "Brain", "group")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
summary(lm(data=dat, T3 ~ T1 + Brain))
library("MASS")
library("lme4")
N = 50
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
set.seed(100)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(1,1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
names(dat) <- c("T1", "Brain", "group")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
summary(lm(data=dat, T3 ~ T1 + Brain))
library("MASS")
library("lme4")
N = 50
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
set.seed(100)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(1,1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
names(dat) <- c("T1", "Brain", "group")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
summary(lm(data=dat, T3 ~ T1 + Brain))
library("MASS")
library("lme4")
N = 50
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
set.seed(100)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(1,1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
names(dat) <- c("T1", "Brain", "group")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
summary(lm(data=dat, T3 ~ T1 + Brain + group))
summary(lmer(data=dat, T3 ~ T1 + Brain + (1|group)))
summary(lm(data=dat, T3 ~ T1 + Brain + group))
summary(lmer(data=dat, T3 ~ T1 + Brain + (1|group)))
library("MASS")
library("lme4")
N = 500
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
set.seed(100)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(1,1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
names(dat) <- c("T1", "Brain", "group")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
summary(lm(data=dat, T3 ~ T1 + Brain + group))
summary(lmer(data=dat, T3 ~ T1 + Brain + (1|group)))
library("MASS")
library("lme4")
N = 1000
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
set.seed(100)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(1,1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
names(dat) <- c("T1", "Brain", "group")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
summary(lm(data=dat, T3 ~ T1 + Brain + group))
summary(lmer(data=dat, T3 ~ T1 + Brain + (1|group)))
library("MASS")
library("lme4")
N = 20
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
set.seed(100)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(1,1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=50))
library("MASS")
library("lme4")
N = 20
effAR = 0.5
effBrain = 0.15
covar = -.20
err <- sqrt(1 - effAR^2 + effBrain^2 + 2*covar)
set.seed(100)
dat1 <- as.data.frame(mvrnorm(n=N, mu=c(0,0), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat2 <- as.data.frame(mvrnorm(n=N, mu=c(0.5,0.5), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat3 <- as.data.frame(mvrnorm(n=N, mu=c(1,1), Sigma=matrix(c(1,  covar, covar, 1), nrow=2)))
dat <- rbind(dat1, dat2, dat3)
dat$group <- as.factor(rep(c("a", "b", "c"), each=N))
names(dat) <- c("T1", "Brain", "group")
dat$T3 <- effAR*dat$T1 + effBrain*dat$Brain + rnorm(N, 0, err)
summary(lm(data=dat, T3 ~ T1 + Brain + group))
summary(lmer(data=dat, T3 ~ T1 + Brain + (1|group)))
